"use strict";(self.webpackChunksrc_rx=self.webpackChunksrc_rx||[]).push([[8222],{66875:(t,e,o)=>{o.d(e,{A:()=>b});var s=o(28437),i=o(22631),n=o(22103),a=o(43333),r=o(14820),l=o(89303),p=o(32075),h=o(16904),d=o(4531),c=o(4848),g=o.n(c),m=o(17774),v=o(70579);const u=["silly","debug","info","warn","error"],f={root:{height:"100%",display:"flex",flexDirection:"column",overflow:"hidden"},scroll:{height:"100%",overflowY:"auto"},instanceIcon:{width:42,height:42,marginRight:16,verticalAlign:"middle"},button:{marginRight:5,width:36,height:36},version:{fontSize:12,opacity:.8,marginLeft:20,marginRight:10},versionAliveConnected:t=>({color:"dark"===t.palette.mode?"#23a623":"#60ff60"}),versionAliveNotConnected:{color:"#a67223"},buttonControl:{padding:"5px",transition:"opacity 0.2s",height:34},enabled:{color:i.A[400],"&:hover":{backgroundColor:i.A[200]}},disabled:{color:n.A[400],"&:hover":{backgroundColor:n.A[200]}},hide:{visibility:"hidden"},formControl:{width:"100%",marginBottom:5},logLevel:{fontSize:12,marginLeft:10},green:{color:i.A[700]},red:{color:n.A[700]},grey:{color:a.A[700]},blue:{color:"#0055a9"},orange:{color:r.A[400]},orangeDevice:{color:r.A[300]},tooltip:{pointerEvents:"none"}};class x extends s.Component{constructor(t){super(t),this.refIframe=void 0,this.registered=void 0,this.onObjectChange=(t,e)=>{var o,s,i,n;t===`system.adapter.${this.props.adapter}.${this.props.instance}`&&this.setState({running:(null===e||void 0===e||null===(o=e.common)||void 0===o?void 0:o.onlyWWW)||(null===e||void 0===e||null===(s=e.common)||void 0===s?void 0:s.enabled),canStart:!(null!==e&&void 0!==e&&null!==(i=e.common)&&void 0!==i&&i.onlyWWW),logLevel:(null===e||void 0===e||null===(n=e.common)||void 0===n?void 0:n.loglevel)||"info"})},this.onStateChange=(t,e)=>{const o=`system.adapter.${this.props.adapter}.${this.props.instance}`;t===`${o}.alive`?this.setState({alive:!(null===e||void 0===e||!e.val)}):t===`${o}.connected`?this.setState({connectedToHost:!(null===e||void 0===e||!e.val)}):t===`${this.props.adapter}.${this.props.instance}.info.connection`?this.setState({connected:e?!!e.val:null}):t===`${this.props.adapter}.${this.props.instance}.info.extension`?this.setState({extension:e?!!e.val:null}):t===`${o}.logLevel`&&this.setState({tempLogLevel:e?e.val:null})},this.closeConfig=t=>{if(t.origin===window.location.origin)if("close"===t.data||"close"===t.message)this.props.easyMode?this.props.handleNavigation("easy"):this.props.handleNavigation("tab-instances");else if("change"===t.data||"change"===t.message)this.props.configStored(!1);else if("nochange"===t.data||"nochange"===t.message)this.props.configStored(!0);else if("string"===typeof t.data&&t.data.startsWith("goto:")||"string"===typeof t.message&&t.message.startsWith("goto:")){const[,e]=(t.data||t.message).split(":"),[o,s,i]=e.split("/");this.props.handleNavigation(o,s,i)}},this.state={checkedExist:!1,showStopAdminDialog:!1,running:!1,canStart:!1,alive:!1,connected:!1,connectedToHost:!1,logOnTheFlyValue:!1,logLevel:"info",logLevelValue:"info",tempLogLevel:"info",showLogLevelDialog:!1},this.refIframe=null,this.registered=!1}componentDidUpdate(){var t;!this.registered&&null!==(t=this.refIframe)&&void 0!==t&&t.contentWindow&&(this.registered=!0,this.props.onRegisterIframeRef(this.refIframe))}componentDidMount(){var t;if(this.props.tab)this.props.socket.fileExists(`${this.props.adapter}.admin`,"tab.html").then((t=>{if(!t)return this.props.socket.fileExists(`${this.props.adapter}.admin`,"tab_m.html").then((t=>t?this.setState({checkedExist:"tab_m.html"}):window.alert("Cannot find tab(_m).html")));this.setState({checkedExist:"tab.html"})}));else{const t=`system.adapter.${this.props.adapter}.${this.props.instance}`;this.props.socket.subscribeObject(t,this.onObjectChange),this.props.socket.getObject(t).then((async e=>{var o,s,i,n,a,r,l,p;const h=await this.props.socket.getState(`${t}.logLevel`);await this.props.socket.subscribeState(`${t}.logLevel`,this.onStateChange);const d=await this.props.socket.getState(`${t}.alive`);await this.props.socket.subscribeState(`${t}.alive`,this.onStateChange);const c=await this.props.socket.getState(`${t}.connected`);let g,m;await this.props.socket.subscribeState(`${t}.connected`,this.onStateChange);try{g=await this.props.socket.getState(`${this.props.adapter}.${this.props.instance}.info.connection`),this.props.socket.subscribeState(`${this.props.adapter}.${this.props.instance}.info.connection`,this.onStateChange)}catch{g=null}try{m=await this.props.socket.getState(`${this.props.adapter}.${this.props.instance}.info.extension`),this.props.socket.subscribeState(`${this.props.adapter}.${this.props.instance}.info.extension`,this.onStateChange)}catch{m=null}this.setState({checkedExist:!0,running:(null===e||void 0===e||null===(o=e.common)||void 0===o?void 0:o.onlyWWW)||(null===e||void 0===e||null===(s=e.common)||void 0===s?void 0:s.enabled),canStart:!(null!==e&&void 0!==e&&null!==(i=e.common)&&void 0!==i&&i.onlyWWW),alive:!(null===d||void 0===d||!d.val),extension:m?!(null===(n=m)||void 0===n||!n.val):null,connectedToHost:!(null===c||void 0===c||!c.val),connected:g?!!g.val:null,logLevel:(null===e||void 0===e||null===(a=e.common)||void 0===a?void 0:a.loglevel)||"info",logLevelValue:(null===e||void 0===e||null===(r=e.common)||void 0===r?void 0:r.loglevel)||"info",tempLogLevel:(null===h||void 0===h?void 0:h.val)||(null===e||void 0===e||null===(l=e.common)||void 0===l?void 0:l.loglevel)||"info",common:(null===e||void 0===e?void 0:e.common)||{},native:(null===e||void 0===e?void 0:e.native)||{},adapterDocLangs:null!==e&&void 0!==e&&null!==(p=e.common)&&void 0!==p&&p.docs?Object.keys(e.common.docs):["en"]})})).catch((t=>{console.error(t),this.setState({checkedExist:!0,running:!1})}))}!this.registered&&null!==(t=this.refIframe)&&void 0!==t&&t.contentWindow&&(this.registered=!0,this.props.onRegisterIframeRef(this.refIframe)),(window.addEventListener||window.attachEvent)(window.addEventListener?"message":"onmessage",this.closeConfig,!1)}getInstanceStatus(){var t,e,o;const s=(null===(t=this.state.common)||void 0===t?void 0:t.mode)||"";let i="daemon"===s?"green":"blue";if(null===(e=this.state.common)||void 0===e||!e.enabled||this.state.common.webExtension&&null!==(o=this.state.native)&&void 0!==o&&o.webInstance&&"daemon"!==s)i="daemon"===s?"grey":"blue";else{var n;if(this.state.common.webExtension&&null!==(n=this.state.native)&&void 0!==n&&n.webInstance&&null!==this.state.extension)return this.state.extension?"green":"red";this.state.connectedToHost&&this.state.alive||(i="daemon"===s?"red":"orangeDevice"),null===this.state.connected||this.state.connected||"red"===i||(i="orange")}return i}componentWillUnmount(){this.props.socket.unsubscribeObject(`system.adapter.${this.props.adapter}.${this.props.instance}`,this.onObjectChange),(window.removeEventListener||window.detachEvent)(window.removeEventListener?"message":"onmessage",this.closeConfig,!1),this.registered&&this.refIframe&&this.props.onUnregisterIframeRef(this.refIframe),this.refIframe=null}renderHelpButton(){return this.props.jsonConfig?(0,v.jsx)("div",{style:{display:"inline-block",position:"absolute",right:0,top:5},children:(0,v.jsx)(l.Tooltip,{title:this.props.t("Show help for this adapter"),slotProps:{popper:{sx:f.tooltip}},children:(0,v.jsx)(l.Fab,{sx:{"&.MuiFab-root":f.button},onClick:()=>{var t;const e=null!==(t=this.state.adapterDocLangs)&&void 0!==t&&t.includes(this.props.lang)?this.props.lang:"en";window.open(m.A.getDocsLinkForAdapter({lang:e,adapterName:this.props.adapter}),"help")},children:(0,v.jsx)(p.Help,{})})})}):null}getConfigurator(){if(this.props.jsonConfig)return(0,v.jsx)(d.JsonConfig,{expertMode:this.props.expertMode,theme:this.props.theme,width:this.props.width,adapterName:this.props.adapter,instance:this.props.instance,socket:this.props.socket,themeName:this.props.themeName,themeType:this.props.themeType,dateFormat:this.props.dateFormat,isFloatComma:this.props.isFloatComma,configStored:this.props.configStored,t:this.props.t,DeviceManager:g()});const t=`adapter/${this.props.adapter}/${this.props.tab?this.state.checkedExist:this.props.materialize?"index_m.html":"index.html"}?${this.props.instance||0}&newReact=true&${this.props.instance||0}&react=${this.props.themeName}`;return this.state.checkedExist?(0,v.jsx)("iframe",{ref:t=>this&&(this.refIframe=t),title:"config",style:this.props.style,src:t}):null}returnStopAdminDialog(){return this.state.showStopAdminDialog?(0,v.jsx)(h.DialogConfirm,{title:this.props.t("Please confirm"),text:this.props.t("stop_admin",this.props.instance),ok:this.props.t("Stop admin"),onClose:t=>{t&&this.props.socket.extendObject(`system.adapter.${this.props.adapter}.${this.props.instance}`,{common:{enabled:!1}}).catch((t=>window.alert(t))),this.setState({showStopAdminDialog:!1})}}):null}renderLogLevelDialog(){return this.state.showLogLevelDialog?(0,v.jsxs)(l.Dialog,{open:!0,onClose:()=>this.setState({showLogLevelDialog:!1}),children:[(0,v.jsx)(l.DialogTitle,{children:this.props.t("Edit log level rule for %s",`${this.props.adapter}.${this.props.instance}`)}),(0,v.jsxs)(l.DialogContent,{children:[(0,v.jsxs)(l.FormControl,{style:{...f.formControl,marginTop:10},variant:"outlined",children:[(0,v.jsx)(l.InputLabel,{children:this.props.t("log level")}),(0,v.jsx)(l.Select,{variant:"standard",value:this.state.logLevelValue,fullWidth:!0,onChange:t=>this.setState({logLevelValue:t.target.value}),children:u.map((t=>(0,v.jsx)(l.MenuItem,{value:t,children:this.props.t(t)},t)))})]}),(0,v.jsxs)(l.FormControl,{style:f.formControl,variant:"outlined",children:[(0,v.jsx)(l.FormControlLabel,{control:(0,v.jsx)(l.Checkbox,{checked:this.state.logOnTheFlyValue,onChange:t=>this.setState({logOnTheFlyValue:t.target.checked})}),label:this.props.t("Without restart")}),(0,v.jsx)(l.FormHelperText,{children:this.state.logOnTheFlyValue?this.props.t("Will be reset to the saved log level after restart of adapter"):this.props.t("Log level will be saved permanently")})]})]}),(0,v.jsxs)(l.DialogActions,{children:[(0,v.jsx)(l.Button,{color:"primary",variant:"contained",onClick:()=>{this.state.logOnTheFlyValue?this.props.socket.setState(`system.adapter.${this.props.adapter}.${this.props.instance}.logLevel`,this.state.logLevelValue):this.props.socket.extendObject(`system.adapter.${this.props.adapter}.${this.props.instance}`,{common:{loglevel:this.state.logLevelValue}}).catch((t=>window.alert(`Cannot set log level: ${t}`))),this.setState({showLogLevelDialog:!1})},children:this.props.t("Ok")}),(0,v.jsx)(l.Button,{color:"grey",variant:"contained",onClick:()=>this.setState({showLogLevelDialog:!1}),children:this.props.t("Cancel")})]})]}):null}render(){return(0,v.jsxs)(l.Paper,{style:f.root,children:[(0,v.jsx)(l.AppBar,{color:"default",position:"static",children:(0,v.jsxs)(l.Toolbar,{variant:"dense",style:{marginLeft:8},children:[(0,v.jsxs)(l.Typography,{variant:"h6",color:"inherit",children:[(0,v.jsx)(l.IconButton,{size:"small",onClick:()=>{this.props.easyMode?this.props.handleNavigation("easy"):this.props.handleNavigation("tab-instances")},onFocus:t=>t.stopPropagation(),style:{marginRight:10},children:(0,v.jsx)(p.ArrowBack,{})}),this.props.jsonConfig?(0,v.jsx)(h.Icon,{src:this.props.icon,style:f.instanceIcon}):null,`${this.props.t("Instance settings")}: ${this.props.adapter}.${this.props.instance}`,this.props.version?(0,v.jsxs)("span",{style:{...f.version,...f[this.getInstanceStatus()]},children:["v",this.props.version]}):null,(0,v.jsx)(l.Tooltip,{title:this.props.t("Start/stop"),slotProps:{popper:{sx:f.tooltip}},children:(0,v.jsx)("span",{children:(0,v.jsx)(l.IconButton,{size:"small",onClick:t=>{t.stopPropagation(),t.preventDefault(),this.state.running&&`${this.props.adapter}.${this.props.instance}`===this.props.adminInstance?this.setState({showStopAdminDialog:!0}):this.props.socket.extendObject(`system.adapter.${this.props.adapter}.${this.props.instance}`,{common:{enabled:!this.state.running}}).catch((t=>window.alert(`Cannot set log level: ${t}`)))},onFocus:t=>t.stopPropagation(),sx:{...f.buttonControl,...this.state.canStart?this.state.running?f.enabled:f.disabled:f.hide},children:this.state.running?(0,v.jsx)(p.Pause,{}):(0,v.jsx)(p.PlayArrow,{})})})}),(0,v.jsx)(l.Tooltip,{title:this.props.t("Restart"),slotProps:{popper:{sx:f.tooltip}},children:(0,v.jsx)("span",{children:(0,v.jsx)(l.IconButton,{size:"small",onClick:t=>{t.stopPropagation(),this.props.socket.extendObject(`system.adapter.${this.props.adapter}.${this.props.instance}`,{}).catch((t=>window.alert(`Cannot set log level: ${t}`)))},onFocus:t=>t.stopPropagation(),style:{...f.buttonControl,...this.state.canStart?void 0:f.hide},disabled:!this.state.running,children:(0,v.jsx)(p.Refresh,{})})})}),this.state.tempLogLevel!==this.state.logLevel?(0,v.jsx)(l.Tooltip,{title:this.props.t("temporary log level"),slotProps:{popper:{sx:f.tooltip}},children:(0,v.jsx)("span",{style:f.logLevel,children:this.state.tempLogLevel})}):null,(0,v.jsx)(l.Tooltip,{title:this.props.t("log level"),slotProps:{popper:{sx:f.tooltip}},children:(0,v.jsx)("span",{style:f.logLevel,children:this.state.tempLogLevel!==this.state.logLevel?`/ ${this.state.logLevel}`:this.state.logLevel})}),(0,v.jsx)(l.Tooltip,{title:this.props.t("Edit log level rule for %s",`${this.props.adapter}.${this.props.instance}`),children:(0,v.jsx)(l.IconButton,{size:"small",onClick:t=>{t.stopPropagation(),this.setState({showLogLevelDialog:!0})},onFocus:t=>t.stopPropagation(),style:{...f.buttonControl,...this.state.canStart?void 0:f.hide,width:34,height:34},children:(0,v.jsx)(p.Edit,{style:{width:20,height:20}})})})]}),this.renderHelpButton()]})}),this.getConfigurator(),this.returnStopAdminDialog(),this.renderLogLevelDialog()]})}}const b=x},58222:(t,e,o)=>{o.r(e),o.d(e,{default:()=>m});var s=o(28437),i=o(89303),n=o(32075),a=o(16904),r=o(66875),l=o(70579);const p={root:t=>({position:"relative",m:"10px",width:300,minHeight:200,background:t.palette.background.default,boxShadow:"0 2px 2px 0 rgba(0, 0, 0, .14),0 3px 1px -2px rgba(0, 0, 0, .12),0 1px 5px 0 rgba(0, 0, 0, .2)",display:"flex",transition:"box-shadow 0.5s",cursor:"pointer","&:hover":{boxShadow:"0 8px 17px 0 rgba(0, 0, 0, .2),0 6px 20px 0 rgba(0, 0, 0, .19)"}}),imageBlock:{background:"silver",minHeight:60,display:"flex",padding:"0 10px 0 10px",position:"relative",justifyContent:"space-between",transition:"background 0.5s"},img:{width:60,height:60,marginTop:20,position:"relative","&:after":{content:'""',position:"absolute",zIndex:2,top:0,left:0,width:"100%",height:"100%",background:'url("img/no-image.png") 100% 100% no-repeat',backgroundSize:"cover",backgroundColor:"#fff"}},adapter:{width:"100%",fontWeight:"bold",fontSize:15,verticalAlign:"middle",marginTop:"auto",borderTop:"1px solid silver",padding:"20px 4px",textAlign:"center",textTransform:"uppercase",textOverflow:"ellipsis",overflow:"hidden",color:"#ffab40"},instanceStateNotAlive1:{backgroundColor:"rgba(192, 192, 192, 0.4)"},wrapperDesc:{display:"flex",flexDirection:"column",width:"100%",overflow:"hidden"},desc:{padding:20,fontSize:15}};function h(t,e){return t&&"object"===typeof t?t[e]||t.en||"":t||""}const d=t=>{let{icon:e,id:o,desc:s,lang:n,navigate:a}=t;return(0,l.jsxs)(i.Card,{onClick:a,sx:p.root,children:[(0,l.jsx)("div",{style:{...p.imageBlock,...p.instanceStateNotAlive1},children:(0,l.jsx)(i.CardMedia,{sx:p.img,component:"img",image:`adapter/${o.split(".")[0]}/${e}`})}),(0,l.jsxs)("div",{style:p.wrapperDesc,children:[(0,l.jsx)("div",{style:p.desc,children:h(s,n)}),(0,l.jsx)("div",{style:p.adapter,children:o})]})]})},c={appBar:t=>({transition:t.transitions.create(["margin","width"],{easing:t.transitions.easing.sharp,duration:t.transitions.duration.leavingScreen})}),wrapperEasyMode:{height:"100%",borderRadius:0},wrapperCard:{padding:"80px 20px 20px",height:"100%",overflowY:"auto"},controlHeight:{display:"flex",flexFlow:"wrap",justifyContent:"center"},img:{width:60,height:60,position:"relative",borderRadius:60},logoWhite:{background:"white"},wrapperHeader:{display:"flex",alignItems:"center"},headerName:{fontSize:24,marginLeft:10},toolBar:{justifyContent:"space-between",margin:"5px 0"},paper:{height:"100%",paddingTop:80},iframe:{height:"100%",width:"100%",background:"#FFF",color:"#000",borderRadius:5,border:"1px solid #888"},IconButtons:{display:"flex"},logoPointer:{cursor:"pointer"}};class g extends s.Component{constructor(t){super(t),this.state={configs:this.props.configs,strictMode:!this.props.configs}}componentDidMount(){this.props.configs||this.props.socket.getEasyMode().then((t=>this.setState({configs:t.configs})))}render(){const{t:t,themeName:e,toggleTheme:o,navigate:s,location:p,socket:h,themeType:g,theme:m,width:v,isFloatComma:u,dateFormat:f,configStored:x,getLocation:b,adminInstance:w}=this.props,{configs:y,strictMode:j}=this.state;if(!y)return(0,l.jsx)(i.CircularProgress,{});const C=p.id,k=y.find((t=>{let{id:e}=t;return e===C}));return(0,l.jsxs)(i.Paper,{style:c.wrapperEasyMode,children:[(0,l.jsx)(i.AppBar,{color:"default",position:"fixed",sx:c.appBar,children:(0,l.jsxs)(i.Toolbar,{style:c.toolBar,children:[(0,l.jsxs)("div",{style:c.wrapperHeader,children:[(0,l.jsx)(i.CardMedia,{onClick:j&&!b().dialog||null!==k&&void 0!==k&&k.tab?()=>s(null!==k&&void 0!==k&&k.tab?"easy":"tab-intro"):null,style:{...c.img,..."colored"===e?c.logoWhite:void 0,...j&&!b().dialog||null!==k&&void 0!==k&&k.tab?c.logoPointer:void 0},component:"img",image:"img/no-image.png"}),(0,l.jsx)("div",{style:c.headerName,children:t("Easy Admin")})]}),(0,l.jsxs)("div",{style:c.IconButtons,children:[(j&&!b().dialog||(null===k||void 0===k?void 0:k.tab))&&(0,l.jsx)(i.IconButton,{size:"large",onClick:()=>s(null!==k&&void 0!==k&&k.tab?"easy":"tab-intro"),children:(0,l.jsx)(n.ArrowBack,{})}),(0,l.jsx)(a.ToggleThemeMenu,{t:t,toggleTheme:o,themeName:e,size:"large"})]})]})}),k?(0,l.jsx)(i.Paper,{style:c.paper,children:(0,l.jsx)(r.A,{expertMode:!0,style:c.iframe,adapter:k.id.split(".")[0],instance:parseInt(k.id.split(".")[1],10),jsonConfig:k.jsonConfig,materialize:k.materialize,tab:null===k||void 0===k?void 0:k.tab,socket:h,easyMode:!0,themeName:e,themeType:g,theme:m,width:v,t:t,lang:this.props.lang,icon:k.icon,adminInstance:w,configStored:x,dateFormat:f,isFloatComma:u,onRegisterIframeRef:t=>this.props.onRegisterIframeRef(t),onUnregisterIframeRef:t=>this.props.onUnregisterIframeRef(t),handleNavigation:this.props.handleNavigation})}):(0,l.jsx)("div",{style:c.wrapperCard,children:(0,l.jsx)("div",{style:c.controlHeight,children:y.sort(((t,e)=>t.id<e.id?-1:t.id>e.id?1:0)).map((t=>(0,l.jsx)(d,{lang:this.props.lang,navigate:()=>s(null,"config",t.id),...t},t.id)))})})]})}}const m=g}}]);
//# sourceMappingURL=8222.98910e8b.chunk.js.map