"use strict";(self.webpackChunksrc_rx=self.webpackChunksrc_rx||[]).push([[3363],{63363:(t,e,i)=>{i.r(e),i.d(e,{default:()=>B});var s=i(4473),o=i(68341),n=i(28437),a=i.n(n),r=i(78613),l=i.n(r),d=i(89303),c=i(32075),h=i(16904),p=i(17774),m=i(29465),g=i(23106),u=i(43333),x=i(22103),f=i(70579);const k="0 2px 2px 0 rgba(0, 0, 0, .14),0 3px 1px -2px rgba(0, 0, 0, .12),0 1px 5px 0 rgba(0, 0, 0, .2)",v="0 8px 17px 0 rgba(0, 0, 0, .2),0 6px 20px 0 rgba(0, 0, 0, .19)",y={root:t=>({padding:".75rem",[t.breakpoints.up("xl")]:{flex:"0 1 20%"}}),card:{display:"flex",minHeight:"235px",position:"relative",overflow:"hidden",maxHeight:"235p","&:hover":{overflowY:"auto",boxShadow:v}},cardInfo:{display:"flex",minHeight:"235px",position:"relative",overflow:"initial",maxHeight:"235p",flexDirection:"column","&:hover":{boxShadow:v}},cardInfoHead:t=>({position:"sticky",top:0,background:t.palette.background.default,display:"flex",width:"100%",justifyContent:"space-between",borderBottom:"1px solid",padding:"5px 5px 0px 5px"}),edit:{opacity:.6,userSelect:"none",pointerEvents:"none"},media:t=>({backgroundColor:"dark"===t.palette.mode?"#535353":"#e2e2e2",maxWidth:"30%"}),img:{width:120,height:"auto",padding:"2rem .5rem",maxWidth:"100%"},contentContainer:{display:"flex",flexDirection:"column",flex:1},content:{height:"170px",flexGrow:1,overflowY:"hidden"},action:{minHeight:"49px",padding:"16px 24px"},expand:{position:"absolute",right:"10px",bottom:"10px"},collapse:{minHeight:"100%",backgroundColor:"#ffffff",position:"absolute",width:"100%"},close:{right:"10px"},save:{right:"50px"},enabled:{color:"#ffffff",backgroundColor:g.A[500],position:"absolute",top:8,right:8,boxShadow:k,"&:hover":{backgroundColor:g.A[300]},"&:focus":{backgroundColor:g.A[500]}},disabled:{color:"#ffffff",backgroundColor:u.A[500],position:"absolute",top:8,right:8,boxShadow:k,"&:hover":{backgroundColor:u.A[300]},"&:focus":{backgroundColor:u.A[500]}},editButton:{color:"#ffffff",backgroundColor:u.A[500],position:"absolute",top:64,right:8,boxShadow:k,"&:hover":{backgroundColor:u.A[300]},"&:focus":{backgroundColor:u.A[500]}},deleteButton:{color:"#ffffff",backgroundColor:x.A[500],position:"absolute",top:120,right:8,boxShadow:k,"&:hover":{backgroundColor:x.A[300]},"&:focus":{backgroundColor:x.A[500]}},contentGrid:{height:"100%"},colorOrange:{color:"#ffcc80"},tooltip:{pointerEvents:"none"}};class j extends n.Component{constructor(t){super(t),this.state={expanded:!1}}static getDerivedStateFromProps(t){return t.edit?{expanded:!1}:null}handleExpandClick(){this.setState({expanded:!this.state.expanded})}renderContent(){return this.props.children}openDialog(){}renderDialogs(){return null}render(){var t,e;const i=this.props.edit?y.edit:void 0;let s=this.props.action.text||this.props.t("Link");return"object"===typeof s&&(s=s[this.props.lang]||s.en),(0,f.jsx)(d.Grid2,{size:{xs:12,sm:6,md:4,lg:3},sx:h.Utils.getStyle(this.props.theme,y.root,this.props.style),children:(0,f.jsx)(d.Link,{href:!this.props.edit&&this.props.action&&this.props.action.link?this.props.action.link:null,underline:"none",target:"_blank",rel:"noopener noreferrer",children:(0,f.jsxs)(d.Card,{sx:y.card,onClick:t=>{t.stopPropagation(),this.openDialog()},children:[this.props.showInfo&&!this.props.offline&&(0,f.jsx)(d.Button,{style:{...y.expand,...i},variant:"contained",size:"small",disabled:this.props.disabled,onClick:()=>this.handleExpandClick(),color:"primary",children:this.props.t("Info")}),(0,f.jsxs)(d.Box,{component:"div",sx:h.Utils.getStyle(this.props.theme,y.media,i,this.props.color&&{backgroundColor:this.props.color},{display:"flex",flexDirection:"column"}),children:[(0,f.jsx)(d.CardMedia,{style:y.img,component:"img",image:this.props.image}),(0,f.jsx)("div",{style:{flex:1,display:"flex",paddingBottom:"5px",paddingLeft:"5px"},children:this.props.warning?(0,f.jsx)(d.Tooltip,{title:this.props.warning,slotProps:{popper:{sx:y.tooltip}},children:(0,f.jsx)(c.Warning,{style:{alignSelf:"end",fontSize:36}})}):null})]}),(0,f.jsxs)("div",{style:{...y.contentContainer,...i},children:[(0,f.jsx)(d.CardContent,{style:y.content,children:(0,f.jsxs)(d.Grid2,{container:!0,direction:"column",wrap:"nowrap",style:y.contentGrid,children:[(0,f.jsx)(d.Typography,{gutterBottom:!0,variant:"h5",component:"h5",children:this.props.title}),this.renderContent()]})}),(null===(t=this.props.action)||void 0===t?void 0:t.link)&&(0,f.jsx)(d.Divider,{}),(null===(e=this.props.action)||void 0===e?void 0:e.link)&&(0,f.jsx)(d.CardActions,{style:y.action,children:(0,f.jsx)("div",{style:y.colorOrange,children:p.A.getText(s,this.props.lang)})})]}),this.props.showInfo&&(0,f.jsx)(d.Collapse,{style:y.collapse,in:this.state.expanded,timeout:"auto",unmountOnExit:!0,children:(0,f.jsxs)(d.Card,{sx:y.cardInfo,children:[(0,f.jsxs)(d.Box,{component:"div",sx:y.cardInfoHead,children:[(0,f.jsx)(d.Typography,{gutterBottom:!0,variant:"h5",component:"h5",children:this.props.t("Info")}),(0,f.jsxs)("div",{children:[(0,f.jsx)(d.IconButton,{size:"small",onClick:()=>{this.props.getHostDescriptionAll&&h.Utils.copyToClipboard(this.props.getHostDescriptionAll().text),this.props.openSnackBarFunc&&this.props.openSnackBarFunc()},children:(0,f.jsx)(h.IconCopy,{})}),(0,f.jsx)(d.IconButton,{size:"small",onClick:()=>this.handleExpandClick(),children:(0,f.jsx)(c.Close,{})})]})]}),(0,f.jsx)(d.CardContent,{children:this.props.getHostDescriptionAll().el})]})}),this.props.edit&&this.props.toggleActivation&&(0,f.jsx)(d.IconButton,{size:"large",sx:this.props.enabled?y.enabled:y.disabled,onClick:()=>this.props.toggleActivation(),children:(0,f.jsx)(c.Check,{})}),this.props.edit&&this.props.onEdit&&(0,f.jsx)(d.IconButton,{size:"large",sx:y.editButton,onClick:()=>this.props.onEdit(),children:(0,f.jsx)(c.Create,{})}),this.props.edit&&this.props.onRemove&&(0,f.jsx)(d.IconButton,{size:"large",sx:y.deleteButton,onClick:()=>this.props.onRemove(),children:(0,f.jsx)(c.Delete,{})}),this.renderDialogs()]})})})}}const C=j,b={rootGrid:{flexGrow:1},closeButton:t=>({position:"absolute",right:8,top:8,color:t.palette.grey[500]}),paper:{},typography:{paddingRight:30},img:{width:"100%",height:"100%",objectFit:"contain"}};class S extends n.Component{constructor(t){super(t),this.cameraUpdateTimer=void 0,this.cameraRef=void 0,this.cameraUpdateTimer=null,this.cameraRef=(0,n.createRef)()}componentDidMount(){this.props.camera&&"text"!==this.props.camera&&(this.cameraUpdateTimer=setInterval((()=>this.updateCamera()),Math.max(parseInt(this.props.interval,10),500)),this.updateCamera())}componentWillUnmount(){this.cameraUpdateTimer&&(clearInterval(this.cameraUpdateTimer),this.cameraUpdateTimer=null)}updateCamera(){if(this.cameraRef.current)if("custom"===this.props.camera){let t=this.props.cameraUrl;this.props.addTs&&(t.includes("?")?t+=`&ts=${Date.now()}`:t+=`?ts=${Date.now()}`),this.cameraRef.current.src=t}else{const t=this.props.camera.split("."),e=t.shift(),i=t.shift();this.props.socket.sendTo(`${e}.${i}`,"image",{name:t.pop(),width:this.cameraRef.current.width}).then((t=>{t&&t.data&&this.cameraRef.current&&(this.cameraRef.current.src=`data:image/jpeg;base64,${t.data}`)}))}}render(){return(0,f.jsxs)(d.Dialog,{onClose:()=>this.props.onClose(),open:!0,maxWidth:"xl",fullWidth:!0,fullScreen:!0,sx:{"& .MuiDialog-paper":b.paper},children:[(0,f.jsx)(d.DialogTitle,{children:(0,f.jsxs)(d.Typography,{component:"h2",variant:"h6",sx:{"&.MuiTypography-root":b.typography},children:[this.props.name,(0,f.jsx)(d.IconButton,{size:"large",sx:b.closeButton,onClick:()=>this.props.onClose(),children:(0,f.jsx)(c.Close,{})})]})}),(0,f.jsx)(d.DialogContent,{dividers:!0,children:(0,f.jsx)("img",{style:b.img,src:"",alt:"camera",ref:this.cameraRef})}),(0,f.jsx)(d.DialogActions,{children:(0,f.jsx)(d.Button,{variant:"contained",autoFocus:!0,onClick:t=>{t.stopPropagation(),this.props.onClose()},color:"primary",startIcon:(0,f.jsx)(c.Close,{}),children:this.props.t("Close")})})]})}}const w=S,N={cameraImg:{width:"100%",height:"100%",maxWidth:200,maxHeight:200,objectFit:"contain"},imgContainer:{height:"100%"},hidden:{display:"none"},imgSkeleton:{transform:"initial"}};const D=class extends C{constructor(t){super(t),this.cameraRef=void 0,this.cameraUpdateTimer=void 0,this.interval=void 0,Object.assign(this.state,{error:!1,dialog:!1,loaded:!1}),this.cameraRef=(0,n.createRef)(),this.cameraUpdateTimer=null,this.interval=t.interval}updateCamera(){if(this.cameraRef.current)if("custom"===this.props.camera){let t=this.props.cameraUrl;this.props.addTs&&(t.includes("?")?t+=`&ts=${Date.now()}`:t+=`?ts=${Date.now()}`),this.cameraRef.current.src=t}else{const t=this.props.camera.split("."),e=t.shift(),i=t.shift();this.props.socket.sendTo(`${e}.${i}`,"image",{name:t.pop(),width:this.cameraRef.current.width}).then((t=>{null!==t&&void 0!==t&&t.data&&this.cameraRef.current&&(this.cameraRef.current.src=`data:image/jpeg;base64,${t.data}`)})).catch((t=>window.alert(`Cannot send to instance: ${t}`)))}}componentDidMount(){this.props.camera&&"text"!==this.props.camera&&(this.cameraUpdateTimer=setInterval((()=>this.updateCamera()),Math.max(parseInt(this.props.interval,10),500)),this.updateCamera())}componentWillUnmount(){this.cameraUpdateTimer&&(clearInterval(this.cameraUpdateTimer),this.cameraUpdateTimer=null)}renderDialogs(){return this.state.dialog?(0,f.jsx)(w,{socket:this.props.socket,camera:this.props.camera,name:this.props.title,t:this.props.t,onClose:()=>{this.props.camera&&"text"!==this.props.camera&&(this.cameraUpdateTimer&&clearInterval(this.cameraUpdateTimer),this.cameraUpdateTimer=setInterval((()=>this.updateCamera()),Math.max(parseInt(this.props.interval,10),500)),this.updateCamera()),this.setState({dialog:!1})},cameraUrl:this.props.cameraUrl}):null}handleImageLoad(){this.state.loaded||this.setState({loaded:!0,error:!1})}handleImageError(){this.state.error||this.setState({loaded:!1,error:!0})}renderContent(){if("custom"===this.props.camera){let t=this.props.cameraUrl;return this.props.addTs&&(t.includes("?")?t+=`&ts=${Date.now()}`:t+=`?ts=${Date.now()}`),(0,f.jsxs)(d.Grid2,{container:!0,style:N.imgContainer,justifyContent:"center",alignItems:"center",children:[(0,f.jsx)("img",{ref:this.cameraRef,src:t,alt:"Camera",style:this.state.loaded&&!this.state.error?N.cameraImg:N.hidden,onLoad:()=>this.handleImageLoad(),onError:()=>this.handleImageError()}),!this.state.loaded&&!this.state.error&&(0,f.jsx)(d.Skeleton,{height:"100%",width:"100%",animation:"wave",style:N.imgSkeleton}),this.state.error&&(0,f.jsx)(c.Error,{fontSize:"large"})]})}return this.props.camera.startsWith("cameras.")?(0,f.jsx)("img",{ref:this.cameraRef,src:"",alt:"camera",style:N.cameraImg}):null}render(){return this.props.camera&&"text"!==this.props.camera?this.interval!==this.props.interval&&(this.interval=this.props.interval,this.cameraUpdateTimer&&clearInterval(this.cameraUpdateTimer),this.cameraUpdateTimer=setInterval((()=>this.updateCamera()),Math.max(parseInt(this.props.interval,10),500))):this.cameraUpdateTimer&&(clearInterval(this.cameraUpdateTimer),this.cameraUpdateTimer=null),super.render()}},I={formControl:{marginTop:32},rootGrid:{flexGrow:1},closeButton:t=>({position:"absolute",right:8,top:8,color:t.palette.grey[500]}),paper:{},typography:{paddingRight:30},editItem:{marginTop:8},editItemSlider:{marginTop:24},labelSlider:{marginTop:16,fontSize:"1rem"},editColor:{width:"100%"},dropZone:{width:"100%",height:100,position:"relative"},dropZoneEmpty:{},image:{height:"100%",width:"auto",objectFir:"contain"},uploadDiv:{position:"relative",width:"100%",height:100,opacity:.9},uploadDivDragging:{opacity:1},uploadCenterDiv:{margin:5,border:"3px dashed grey",borderRadius:5,width:"calc(100% - 10px)",height:"calc(100% - 10px)",position:"relative"},uploadCenterIcon:{paddingTop:10,width:48,height:48},uploadCenterText:{fontSize:16},uploadCenterTextAndIcon:{textAlign:"center",position:"absolute",top:0,bottom:0,left:0,right:0}};class L extends n.Component{constructor(t){super(t),this.state={image:"",name:t.t("New link"),link:"http://",linkName:"",color:"",desc:"",addTs:!0,interval:5e3,camera:"text",cameraList:[],...t.link}}componentDidMount(){this.getCamerasInstances()}getCamerasInstances(){this.props.socket.getAdapterInstances("cameras",!0).then((t=>{const e=[],i=[];t.forEach((t=>{const s=t._id.replace("system.adapter.","");t.common&&t.common.enabled&&i.push(this.props.socket.getState(`${t._id}.alive`).then((t=>t&&t.val&&this.props.socket.sendTo(s,"list",null))).then((t=>t&&t.list&&t.list.forEach((t=>e.push({id:t.id,name:`${t.desc} [${s}/${t.name}]`}))))))})),Promise.all(i).then((()=>this.setState({cameraList:e})))}))}static getLinkNameFromLink(t){const e=t.trim().match(/^https?:\/\/([^/:]+)(:\d+)?/);return e?e[1]+(e[2]||""):""}render(){return(0,f.jsxs)(d.Dialog,{onClose:()=>this.props.onClose(),open:!0,maxWidth:"md",fullWidth:!0,sx:{"& .MuiDialog-paper":I.paper},children:[(0,f.jsx)(d.DialogTitle,{children:(0,f.jsxs)(d.Typography,{component:"h2",variant:"h6",sx:{"&.MuiTypography-root":I.typography},children:[this.props.isNew?this.props.t("Add new link: "):this.props.t("Edit link"),(0,f.jsx)(d.IconButton,{size:"large",sx:I.closeButton,onClick:()=>this.props.onClose(),children:(0,f.jsx)(c.Close,{})})]})}),(0,f.jsx)(d.DialogContent,{dividers:!0,children:(0,f.jsxs)(d.Grid2,{style:I.rootGrid,container:!0,direction:"row",children:[(0,f.jsx)(d.Grid2,{size:{xs:12,sm:6,md:8,lg:9},children:(0,f.jsxs)(d.Grid2,{container:!0,direction:"column",children:[(0,f.jsxs)(d.FormControl,{variant:"standard",style:I.formControl,children:[(0,f.jsx)(d.InputLabel,{id:"select-helper-label",children:this.props.t("Link type")}),(0,f.jsxs)(d.Select,{variant:"standard",labelId:"select-helper-label",value:this.state.camera,onChange:t=>this.setState({camera:t.target.value}),children:[(0,f.jsx)(d.MenuItem,{value:"text",children:(0,f.jsx)("em",{children:this.props.t("Description")})},"desc"),this.state.cameraList.map((t=>(0,f.jsx)(d.MenuItem,{value:t.id,children:t.name},t.id))),(0,f.jsx)(d.MenuItem,{value:"custom",children:this.props.t("Custom camera URL")},"custom")]})]}),(0,f.jsx)(d.TextField,{variant:"standard",label:this.props.t("URL"),value:this.state.link,style:I.editItem,onChange:t=>{const e=L.getLinkNameFromLink(this.state.link);!e||this.state.linkName&&e!==this.state.linkName?this.setState({link:t.target.value}):this.setState({link:t.target.value,linkName:L.getLinkNameFromLink(t.target.value)})},slotProps:{input:{endAdornment:this.state.link?(0,f.jsx)(d.InputAdornment,{position:"end",children:(0,f.jsx)(d.IconButton,{size:"small",onClick:()=>this.setState({link:""}),children:(0,f.jsx)(c.Close,{})})}):null}}}),(0,f.jsx)(d.TextField,{variant:"standard",style:I.editItem,label:this.props.t("Name"),value:this.state.name||"",onChange:t=>this.setState({name:t.target.value}),slotProps:{input:{endAdornment:this.state.name?(0,f.jsx)(d.InputAdornment,{position:"end",children:(0,f.jsx)(d.IconButton,{size:"small",onClick:()=>this.setState({name:""}),children:(0,f.jsx)(c.Close,{})})}):null}}}),this.state.link?(0,f.jsx)(d.TextField,{variant:"standard",style:I.editItem,label:this.props.t("Link name"),value:this.state.linkName||"",onChange:t=>this.setState({linkName:t.target.value}),slotProps:{input:{endAdornment:this.state.linkName?(0,f.jsx)(d.InputAdornment,{position:"end",children:(0,f.jsx)(d.IconButton,{size:"small",onClick:()=>this.setState({linkName:""}),children:(0,f.jsx)(c.Close,{})})}):null}}}):null,"custom"===this.state.camera||"text"===this.state.camera?(0,f.jsx)(d.TextField,{variant:"standard",style:I.editItem,label:"custom"===this.state.camera?this.props.t("Camera URL"):this.props.t("Description"),value:this.state.desc||"",onChange:t=>this.setState({desc:t.target.value}),slotProps:{input:{endAdornment:this.state.desc?(0,f.jsx)(d.InputAdornment,{position:"end",children:(0,f.jsx)(d.IconButton,{size:"small",onClick:()=>this.setState({desc:""}),children:(0,f.jsx)(c.Close,{})})}):null}}}):null,"custom"===this.state.camera?(0,f.jsx)(d.FormControlLabel,{style:I.editItem,control:(0,f.jsx)(d.Checkbox,{checked:this.state.addTs,onChange:t=>this.setState({addTs:t.target.checked})}),label:this.props.t("Add timestamp to URL")}):null,"text"!==this.state.camera?(0,f.jsx)(d.Typography,{style:I.labelSlider,gutterBottom:!0,children:"Polling interval in ms"}):null,"text"!==this.state.camera?(0,f.jsx)(d.Slider,{style:I.editItemSlider,value:this.state.interval,getAriaValueText:()=>`${this.state.interval}ms`,onChange:(t,e)=>this.setState({interval:e}),step:100,min:500,max:6e4,valueLabelDisplay:"on"}):null,(0,f.jsx)("div",{style:{...I.editItem,width:50},children:(0,f.jsx)(d.TextField,{variant:"standard",fullWidth:!0,label:this.props.t("Color"),style:I.editColor,type:"color",value:this.state.color,onChange:t=>this.setState({color:t.target.value})})}),(0,f.jsx)(h.UploadImage,{disabled:!1,crop:!0,maxSize:262144,icon:this.state.image,removeIconFunc:()=>this.setState({image:""}),onChange:t=>this.setState({image:t})})]})}),(0,f.jsx)(d.Grid2,{size:{xs:12,sm:6,md:4,lg:3},children:"text"===this.state.camera?(0,f.jsx)(C,{image:this.state.image,title:this.state.name,action:{link:this.state.link,text:this.state.linkName},t:this.props.t,lang:this.props.lang,style:{width:"100% !important",maxWidth:"100% !important",marginLeft:"8px"},color:this.state.color,enabled:!0,theme:this.props.theme,children:this.state.desc}):(0,f.jsx)(D,{interval:this.state.interval,camera:this.state.camera,addTs:this.state.addTs,style:{width:"100% !important",maxWidth:"100% !important",marginLeft:"8px"},image:this.state.image,title:this.state.name,socket:this.props.socket,action:{link:this.state.link,text:this.state.linkName},t:this.props.t,lang:this.props.lang,color:this.state.color,enabled:!0,cameraUrl:this.state.desc,theme:this.props.theme})})]})}),(0,f.jsxs)(d.DialogActions,{children:[(0,f.jsx)(d.Button,{variant:"contained",autoFocus:!0,onClick:()=>{this.props.onClose({link:this.state.link,name:this.state.name,desc:this.state.desc,linkName:this.state.linkName,color:this.state.color,image:this.state.image,addTs:this.state.addTs,camera:this.state.camera,interval:this.state.interval})},color:"primary",startIcon:this.props.isNew?(0,f.jsx)(c.Add,{}):(0,f.jsx)(c.Check,{}),children:this.props.isNew?this.props.t("Add"):this.props.t("Save")}),(0,f.jsx)(d.Button,{variant:"contained",onClick:()=>this.props.onClose(),color:"grey",startIcon:(0,f.jsx)(c.Close,{}),children:this.props.t("Close")})]})]})}}const T=L;class O extends a().Component{constructor(t){super(t),this.state={inProgress:!1,success:!1,error:"",finished:!1}}render(){return(0,f.jsxs)(d.Dialog,{open:!0,maxWidth:"lg",fullWidth:!0,children:[(0,f.jsx)(d.DialogTitle,{children:h.I18n.t("Node.js upgrade")}),(0,f.jsxs)(d.DialogContent,{style:{height:100,padding:"0 20px",overflow:"hidden"},children:[this.state.finished?null:(0,f.jsx)(d.Typography,{children:h.I18n.t("Performing this update will restart the js-controller afterwards!")}),this.state.inProgress?(0,f.jsx)(d.Box,{sx:{display:"flex",justifyContent:"center"},children:(0,f.jsx)(d.CircularProgress,{})}):null,this.state.success?(0,f.jsx)(d.Typography,{children:h.I18n.t("Node.js update successful, restarting controller now!")}):null,this.state.error?(0,f.jsx)(d.Typography,{sx:{color:"red"},children:h.I18n.t("Node.js update failed: %s",this.state.error)}):null]}),(0,f.jsxs)(d.DialogActions,{children:[(0,f.jsx)(d.Button,{disabled:this.state.inProgress||this.state.finished,color:"primary",variant:"contained",startIcon:(0,f.jsx)(c.Refresh,{}),onClick:()=>this.updateNodeJsVersion(),children:h.I18n.t("Upgrade")}),(0,f.jsx)(d.Button,{disabled:this.state.inProgress,variant:"contained",onClick:()=>{this.props.onClose()},color:"primary",startIcon:(0,f.jsx)(c.Close,{}),children:h.I18n.t("Close")})]})]})}async updateNodeJsVersion(){this.setState({inProgress:!0});const t=await this.props.socket.upgradeOsPackages(this.props.hostId,[{name:"nodejs"}],!0);this.setState({inProgress:!1,success:t.success,error:t.error,finished:!0})}}const A={root:{width:"100%",height:"100%"},button:{position:"absolute",bottom:16,right:16},saveButton:t=>({backgroundColor:t.palette.success.main,right:80,"&:hover":{backgroundColor:t.palette.success.dark}}),addButton:t=>({backgroundColor:t.palette.secondary.main,right:144,"&:hover":{backgroundColor:t.palette.secondary.dark}}),closeButton:t=>({backgroundColor:t.palette.error.main,"&:hover":{backgroundColor:t.palette.error.dark}}),bold:{fontWeight:"bold"},container:{overflowY:"auto"},hostOffline:{color:"#bb0000"},updateExists:{color:"#c28700",marginRight:4},updateNo:{color:"#00b204",marginRight:4},nodeUpdate:{opacity:.6},instanceNumber:{opacity:.7,fontSize:16},updateIcon:{cursor:"pointer",fontSize:16},tooltip:{pointerEvents:"none"}},U={Uptime:p.A.formatSeconds,"System uptime":p.A.formatSeconds,RAM:p.A.formatRam,Speed:p.A.formatSpeed,"Disk size":p.A.formatBytes,"Disk free":p.A.formatBytes};var $=(0,o.A)("THRESHOLD_TIME_DIFF_MS"),_=(0,o.A)("ONE_MINUTE_MS");class P extends a().Component{constructor(t){super(t),Object.defineProperty(this,$,{writable:!0,value:18e5}),Object.defineProperty(this,_,{writable:!0,value:6e4}),this.currentProxyPath=window.location.pathname,this.introLinksOriginal=void 0,this.deactivatedOriginal=void 0,this.t=void 0,this.getDataTimeout=void 0,this.updateHostsAlive=async t=>{const e=JSON.parse(JSON.stringify(this.state.alive)),i=[];if(t.find((t=>"deleted"===t.type)))this.getDataDelayed();else if(t.forEach((t=>{!!e[t.id]!==!!t.alive&&(e[t.id]=t.alive,i.push(t.id))})),i.length){const t=JSON.parse(JSON.stringify(this.state.hostsData));(await Promise.all(i.map((t=>this.getHostData(t,e[t]))))).forEach((e=>t[e.id]=P.preprocessHostData(e.data))),this.setState({alive:e,hostsData:t},(()=>this.checkBackendTime()))}},this.updateHosts=t=>{let e=[];if(t.find((t=>!t.obj)))this.getDataDelayed();else if(e=t.map((t=>t.id)),e.length){const t=JSON.parse(JSON.stringify(this.state.hostsData));Promise.all(e.map((t=>this.getHostData(t)))).then((e=>{e.forEach((e=>t[e.id]=P.preprocessHostData(e.data))),this.setState({hostsData:t})}))}},this.getDataDelayed=t=>{this.getDataTimeout&&clearTimeout(this.getDataTimeout),this.getDataTimeout=setTimeout((()=>{this.getDataTimeout=void 0,this.getData(!0).catch((t=>console.error(`Cannot get data: ${t}`)))}),300)},this.state={instances:null,deactivated:[],edit:!1,link:null,introLinks:[],editLink:!1,editLinkIndex:-1,openSnackBar:!1,hasUnsavedChanges:!1,reverseProxy:null,alive:{},hostsData:{},hosts:null,hostTimeDiffMap:new Map,nodeUpdateSupported:!1,nodeUpdateDialog:null},this.t=t.t}checkBackendTime(){const t=this.state.hostTimeDiffMap;for(const[e,i]of Object.entries(this.state.hostsData)){const s=new Date,o=Math.abs(i.time-s.getTime());t.set(e,o)}this.setState({hostTimeDiffMap:t})}async componentDidMount(){var t;await this.getData(),this.props.instancesWorker.registerHandler(this.getDataDelayed),this.props.hostsWorker.registerHandler(this.updateHosts),this.props.hostsWorker.registerAliveHandler(this.updateHostsAlive);const e=await this.props.socket.checkFeatureSupported("CONTROLLER_OS_PACKAGE_UPGRADE"),i=await this.props.socket.getObject(`system.adapter.${this.props.adminInstance}`);this.setState({nodeUpdateSupported:e,reverseProxy:(null===i||void 0===i||null===(t=i.native)||void 0===t?void 0:t.reverseProxy)||[]}),this.checkBackendTime()}componentWillUnmount(){this.getDataTimeout&&(clearTimeout(this.getDataTimeout),this.getDataTimeout=void 0),this.props.instancesWorker.unregisterHandler(this.getDataDelayed),this.props.hostsWorker.unregisterHandler(this.updateHosts),this.props.hostsWorker.unregisterAliveHandler(this.updateHostsAlive)}async activateEditMode(){var t;const e=await this.props.socket.getSystemConfig(!0),i=await this.getInstances(!0,null,e),s=null!==e&&void 0!==e&&null!==(t=e.native)&&void 0!==t&&t.introLinks?e.native.introLinks:[];this.introLinksOriginal=JSON.stringify(s),this.deactivatedOriginal=JSON.parse(JSON.stringify(i.deactivated)),this.setState({instances:i.instances,deactivated:i.deactivated,edit:!0,introLinks:s,hasUnsavedChanges:!1})}deactivateEditMode(){this.state.hasUnsavedChanges,this.setState({deactivated:this.deactivatedOriginal,introLinks:JSON.parse(this.introLinksOriginal),hasUnsavedChanges:!1,edit:!1},(()=>{this.deactivatedOriginal=null,this.introLinksOriginal=null}))}toggleCard(t,e){if(!this.state.instances||!this.state.instances.length)return;const i=JSON.parse(JSON.stringify(this.state.deactivated)),s=i.indexOf(`${t}_${e}`);-1!==s?i.splice(s,1):(i.push(`${t}_${e}`),i.sort());const o=JSON.stringify(i)!==JSON.stringify(this.deactivatedOriginal)||JSON.stringify(this.state.introLinks)!==this.introLinksOriginal;this.setState({deactivated:i,hasUnsavedChanges:o})}getInstancesCards(){var t;return null===(t=this.state.instances)||void 0===t?void 0:t.map((t=>{var e;const i=!(null!==(e=this.state.deactivated)&&void 0!==e&&e.includes(`${t.id}_${t.linkName}`));if(i||this.state.edit){var o;let e=t.link?t.link.replace(/^https?:\/\//,""):"";if(e=e.split("/")[0],t.id===this.props.adminInstance)return null;let a=window.isFinite(t.id.split(".").pop());var n;if(a)a=!(null===(n=this.state.instances)||void 0===n||!n.find((e=>e.id!==t.id&&t.name===e.name&&t.id.split(".")[0]===e.id.split(".")[0])));const r=this.state.hostsData?this.state.hostsData[t.id]:null,l=null!==(o=this.state.hostTimeDiffMap.get(t.id))&&void 0!==o?o:0;return(0,f.jsx)(C,{image:t.image,title:(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("span",{style:t.name&&t.name.length>12?{fontSize:"1rem"}:void 0,children:t.name}),a?(0,f.jsxs)("span",{style:A.instanceNumber,children:[".",t.id.split(".").pop()]}):null]}),action:{link:t.link,text:e},t:this.props.t,lang:this.props.lang,color:t.color,showInfo:!!t.info,edit:this.state.edit,offline:r&&!1===r.alive,warning:l>(0,s.A)(this,$)[$]?this.t("Backend time differs by %s minutes",Math.round(l/(0,s.A)(this,_)[_]).toString()):null,enabled:i,disabled:!r||"object"!==typeof r,getHostDescriptionAll:()=>this.getHostDescriptionAll(t.id),toggleActivation:()=>this.toggleCard(t.id,t.linkName),openSnackBarFunc:()=>this.setState({openSnackBar:!0}),theme:this.props.theme,children:t.description||this.getHostDescription(t.id)},`${t.id}_${t.link}`)}return null}))}toggleLinkCard(t){const e=JSON.parse(JSON.stringify(this.state.introLinks));e[t].enabled=!e[t].enabled;const i=JSON.stringify(this.state.deactivated)!==JSON.stringify(this.deactivatedOriginal)||JSON.stringify(e)!==this.introLinksOriginal;this.setState({introLinks:e,hasUnsavedChanges:i})}getLinkCards(){var t;return null===(t=this.state.introLinks)||void 0===t?void 0:t.map(((t,e)=>t.enabled||this.state.edit?"custom"===t.camera?(0,f.jsx)(D,{image:t.image,title:t.name,action:{link:t.link,text:t.linkName},t:this.props.t,socket:this.props.socket,color:t.color,edit:this.state.edit,interval:t.interval,camera:t.camera,addTs:t.addTs,onEdit:()=>{var t;return this.setState({editLink:!0,editLinkIndex:e,link:JSON.parse(JSON.stringify(null===(t=this.state.introLinks)||void 0===t?void 0:t[e]))})},onRemove:()=>{const t=JSON.parse(JSON.stringify(this.state.introLinks));t.splice(e,1);const i=JSON.stringify(this.state.deactivated)!==JSON.stringify(this.deactivatedOriginal)||JSON.stringify(t)!==this.introLinksOriginal;this.setState({introLinks:t,hasUnsavedChanges:i})},enabled:t.enabled,lang:this.props.lang,toggleActivation:()=>this.toggleLinkCard(e),cameraUrl:t.desc,theme:this.props.theme},`link${e}`):(0,f.jsx)(C,{image:t.image,title:t.name,action:{link:t.link,text:t.linkName},t:this.props.t,color:t.color,edit:this.state.edit,onEdit:()=>{var t;return this.setState({editLink:!0,editLinkIndex:e,link:JSON.parse(JSON.stringify(null===(t=this.state.introLinks)||void 0===t?void 0:t[e]))})},onRemove:()=>{const t=JSON.parse(JSON.stringify(this.state.introLinks));t.splice(e,1);const i=JSON.stringify(this.state.deactivated)!==JSON.stringify(this.deactivatedOriginal)||JSON.stringify(t)!==this.introLinksOriginal;this.setState({introLinks:t,hasUnsavedChanges:i})},enabled:t.enabled,lang:this.props.lang,toggleActivation:()=>this.toggleLinkCard(e),theme:this.props.theme,children:t.desc||""},`link${e}`):null))}editLinkCard(){return this.state.editLink?(0,f.jsx)(T,{link:this.state.link,socket:this.props.socket,isNew:-1===this.state.editLinkIndex,t:this.props.t,lang:this.props.lang,theme:this.props.theme,onClose:t=>{if(t){const e=JSON.parse(JSON.stringify(this.state.introLinks));-1===this.state.editLinkIndex?(t.enabled=!0,e.push(t)):(t.enabled=e[this.state.editLinkIndex].enabled,e[this.state.editLinkIndex]=t);const i=JSON.stringify(this.state.deactivated)!==JSON.stringify(this.deactivatedOriginal)||JSON.stringify(e)!==this.introLinksOriginal;this.setState({introLinks:e,editLink:!1,hasUnsavedChanges:i,link:null})}else this.setState({editLink:!1})}}):null}getButtons(){const t=[];return this.state.edit?(t.push((0,f.jsx)(d.Fab,{color:"primary",size:"small",sx:h.Utils.getStyle(this.props.theme,A.button,A.addButton),onClick:()=>this.setState({editLink:!0,editLinkIndex:-1,link:{}}),children:(0,f.jsx)(c.Add,{})},"add")),t.push((0,f.jsx)(d.Fab,{size:"small",color:"primary",disabled:!this.state.hasUnsavedChanges,sx:h.Utils.getStyle(this.props.theme,A.button,A.saveButton),onClick:()=>this.saveCards(),children:(0,f.jsx)(c.Check,{})},"save")),t.push((0,f.jsx)(d.Fab,{size:"small",color:"primary",sx:h.Utils.getStyle(this.props.theme,A.button,A.closeButton),onClick:()=>this.deactivateEditMode(),children:(0,f.jsx)(c.Close,{})},"close"))):t.push((0,f.jsx)(d.Fab,{color:"primary",size:"small",style:A.button,onClick:()=>this.activateEditMode(),children:(0,f.jsx)(c.Create,{})},"edit")),t}async saveCards(){const t=await this.props.socket.getSystemConfig(!0);let e=!1;JSON.stringify(t.common.intro)!==JSON.stringify(this.state.deactivated)&&(t.common.intro=this.state.deactivated,e=!0),e||JSON.stringify(t.native.introLinks)===JSON.stringify(this.state.introLinks)||(e=!0,t.native.introLinks=this.state.introLinks),e?this.props.socket.setSystemConfig(t).then((()=>this.props.showAlert("Updated","success"))).catch((t=>{console.log(t),this.props.showAlert(t,"error")})).then((()=>this.setState({edit:!1}))):this.setState({edit:!1})}async getHostData(t,e){var i;let s;if(void 0!==e)s={val:e};else try{s=await this.props.socket.getState(`${t}.alive`)}catch(a){console.error(`Cannot get state ${t}.alive: ${a}`),s={val:!1}}let o={alive:!1};if(null!==(i=s)&&void 0!==i&&i.val)try{o=await this.props.socket.getHostInfo(t,!1,1e4),o&&"object"===typeof o&&!1!==o.alive&&(o.alive=!0)}catch(a){console.error(`Cannot get host info for ${t}: ${a}`),o={alive:!1}}else o={alive:!1};const n=await this.props.socket.getForeignStates(`${t}.versions.*`);return Object.keys(n).forEach((t=>o[`_${t.split(".").pop()}`]=n[t].val)),{id:t,data:o}}async getHostsData(t){const e=t.map((t=>this.getHostData(t._id))),i=await Promise.all(e),s={},o={};return i.forEach((t=>{s[t.id]=P.preprocessHostData(t.data),o[t.id]=t.data.alive})),{hostsData:s,alive:o}}static applyReverseProxy(t,e,i){null===t||void 0===t||t.paths.forEach((t=>{if(t.instance===i.id)i.link=t.path;else if(t.instance.startsWith("web.")){var s;const o=e[`system.adapter.${t.instance}`];if(null!==o&&void 0!==o&&null!==(s=o.native)&&void 0!==s&&s.port&&i.link.includes(`:${o.native.port}`)){const e=new RegExp(`^.*:${o.native.port}/`);i.link&&(i.link=i.link.replace(e,t.path)),console.log(i.link)}}}))}addLinks(t,e,i,s,o,n){var a;const r={id:t.id,name:t.name,description:t.description,color:t.color,image:t.icon,info:""},l=(0,m.td)(t.link,e.name,i,{instances:s,hostname:this.props.hostname,adminInstance:this.props.adminInstance,hosts:o});let d=null;if(null!==(a=this.state.reverseProxy)&&void 0!==a&&a.length&&(d=this.state.reverseProxy.find((t=>t.globalPath===this.currentProxyPath))),1===l.length){r.link=l[0].url,r.port=l[0].port,P.applyReverseProxy(d,s,r);const t=n.find((t=>t.link===r.link));t?console.log(`Double links: "${r.id}" and "${t.id}"`):n.push(r)}else l.length>1&&l.forEach((t=>{const e=n.find((e=>e.link===t.url));if(e)console.log(`Double links: "${r.id}" and "${e.id}"`);else{const e={...r,link:t.url,port:t.port};P.applyReverseProxy(d,s,e),n.push(e)}}))}static getText(t,e){return t?"object"===typeof t?t[e]||t.en||"":t||"":""}static normalizeLinks(t,e,i){if(!t.common.localLinks&&!t.common.localLink&&!t.common.welcomeScreen&&!t.common.welcomeScreenPro)return null;const s={id:t._id.replace("system.adapter.",""),link:"",name:P.getText(t.common.titleLang||t.common.title||t.common.name,e),order:t.common.order||1e3,intro:!0,description:P.getText(t.common.desc,e),icon:t.common.icon?`adapter/${t.common.name}/${t.common.icon}`:"img/no-image.png"};let o=[];if(t.common.localLink)if("string"===typeof t.common.localLink)o.push({...s,link:t.common.localLink});else{const e=t.common.localLink;if(e.link){const t={...s,link:e.link};e.color&&(t.color=e.color),void 0!==e.order&&"number"===typeof e.order&&(t.order=e.order),e.icon&&e.img&&(t.icon=e.icon||e.img),o.push(t)}else console.warn(`Unknown localLink structure: ${JSON.stringify(t.common.localLink)}`)}if(t.common.localLinks&&"object"===typeof t.common.localLinks&&Object.keys(t.common.localLinks).forEach((i=>{const n=t.common.localLinks[i];if("string"===typeof n)o.push({...s,link:n});else{const a=n;if(a.link){const n={...s,id:t._id.replace("system.adapter.","")+("_default"===i?"":` ${i}`),link:a.link,name:s.name+("_default"===i?"":` ${i}`)};a.color&&(n.color=a.color),void 0!==a.order&&(n.order=parseInt(a.order,10)||1e3),a.icon&&a.img&&(n.icon=a.icon||a.img),a.description&&(n.description=P.getText(a.description,e)),void 0!==a.pro&&("string"===typeof a.pro?n.pro=a.pro:n.pro=`${t.common.name}/index.html`),void 0!==a.cloud&&(n.cloud=a.cloud),void 0!==a.intro&&(n.intro=!0===a.intro),a.name&&(n.name=P.getText(a.name,e)),"_default"===i&&(n.default=!0),o.push(n)}else console.warn(`Unknown localLinks structure: ${JSON.stringify(n)}`)}})),t.common.welcomeScreen&&"object"===typeof t.common.welcomeScreen){if((Array.isArray(t.common.welcomeScreen)?t.common.welcomeScreen:[t.common.welcomeScreen]).forEach((i=>{if(i.link){const n={...s,id:`${t._id.replace("system.adapter.","")} cloud`,link:`%web_protocol%://%web_bind%:%web_port%/${i.link}`,cloud:i.link};if(i.color&&(n.color=i.color),void 0!==i.order&&"number"===typeof i.order&&(n.order=i.order),i.icon&&i.img&&(n.icon=i.icon||i.img),i.localLinks){const e=t.common.localLinks[i.localLinks];e&&"string"===typeof e?n.link=e:e&&"object"===typeof e&&e.link&&(n.link=e.link)}i.name&&(n.name=P.getText(i.name,e)),o.push(n)}})),t.common.welcomeScreenPro&&"object"===typeof t.common.welcomeScreenPro){(Array.isArray(t.common.welcomeScreenPro)?t.common.welcomeScreenPro:[t.common.welcomeScreenPro]).forEach((i=>{if(i.link){const n={...s,id:`${t._id.replace("system.adapter.","")} pro`,link:`%web_protocol%://%web_bind%:%web_port%/${i.link}`,pro:i.link};if(i.color&&(n.color=i.color),void 0!==i.order&&"number"===typeof i.order&&(n.order=i.order),i.icon&&i.img&&(n.icon=i.icon||i.img),i.localLinks){const e=t.common.localLinks[i.localLinks];e&&"string"===typeof e?n.link=e:e&&"object"===typeof e&&e.link&&(n.link=e.link)}i.name&&(n.name=P.getText(i.name,e)),o.push(n)}}))}}if(o.forEach((e=>{e.icon.startsWith("adapter/")||e.icon.startsWith("data:image/")||e.icon.startsWith("http://")||e.icon.startsWith("https://")||"img/no-image.png"===e.icon||(e.icon=`adapter/${t.common.name}/${e.icon}`)})),i){const t={};o.forEach((e=>{t[e.link]?(e.color&&(t[e.link].color=e.color),e.icon&&(t[e.link].icon=e.icon),e.cloud&&(t[e.link].cloud=e.cloud),e.pro&&(t[e.link].pro=e.pro),void 0!==e.intro&&(t[e.link].intro=e.intro),e.name&&"object"===typeof e.name&&(t[e.link].name=e.name),void 0!==e.order&&(t[e.link].order=e.order),e.default&&(t[e.link].default=e.default)):t[e.link]=e})),o=Object.values(t)}return o.sort(((t,e)=>void 0===t.default&&void 0===e.default?void 0===t.order&&void 0===e.order?0:void 0===t.order?-1:void 0===e.order?1:t.order-e.order:void 0===t.default?-1:void 0===e.default?1:void 0===t.order&&void 0===e.order?0:void 0===t.order?-1:void 0===e.order?1:t.order-e.order)),o}async getInstances(t,e,i){e=e||this.state.hosts;const s={};e.forEach((t=>s[t._id]=t));try{var o;const n=await this.props.socket.getAdapterInstances("",t);let a=i.common.intro||[];Array.isArray(a)||(a=Object.keys(a),a.sort());const r=[],l={};n.forEach((t=>l[t._id]=t)),n.forEach((t=>{var e;if(!t)return;const i=t.common||null,o=t._id.split("."),n=parseInt(o.pop(),10);let a;if(null!==i&&void 0!==i&&i.name&&"object"===typeof i.name){const t=null===i||void 0===i?void 0:i.name;a=t[this.props.lang]||t.en}else a=(null===i||void 0===i?void 0:i.name)||"";if(("admin"!==a||i.localLink!==(this.props.hostname||""))&&"web"!==a&&(!a||"vis-web-admin"===a||!a.match(/^vis-/)||"vis-2"===a)&&(null===(e=a)||void 0===e||!e.match(/^icons-/))&&i&&(i.enabled||i.onlyWWW)){const e=P.normalizeLinks(t,this.props.lang,!0);e&&e.forEach((t=>this.addLinks(t,i,n,l,s,r)))}})),r.forEach((t=>{t.link&&(t.linkName=t.link.replace("https://","").replace("http://","").replace(/^[^_]+:/,""))})),r.sort(((t,e)=>{if(void 0!==t.order||void 0!==e.order){if(t.order=void 0===t.order?1e3:t.order,e.order=void 0===e.order?1e3:e.order,t.order<e.order)return-1;if(t.order>e.order)return 1}return t.id>e.id?1:t.id<e.id?-1:0})),null===(o=e)||void 0===o||o.forEach((t=>{const e=null===t||void 0===t?void 0:t.common;let i=null===e||void 0===e?void 0:e.name;if("object"===typeof i&&i&&(i=i[this.props.lang]||i.en),e){const s={id:t._id,name:i||"",color:"",image:e.icon||"img/no-image.png",info:this.t("Info"),linkName:""};r.push(s)}}));const d=[];return a.forEach((t=>{r.find((e=>t===`${e.id}_${e.linkName}`))&&d.push(t)})),a=d,{instances:r,deactivated:a}}catch(n){return console.log(n),{instances:[],deactivated:[]}}}getHostDescription(t){const e=this.state.hostsData?this.state.hostsData[t]:null;if(e&&!1===e.alive)return(0,f.jsx)("div",{style:A.hostOffline,children:this.props.t("Offline")});let i="",s="";if(e){try{e._nodeNewest&&e["Node.js"]&&l().gt(e._nodeNewest,e["Node.js"].replace(/^v/,""))&&(i=e._nodeNewest)}catch{}try{e._nodeNewest!==e._nodeNewestNext&&e._nodeNewestNext&&e["Node.js"]&&e._nodeNewest&&l().gt(e._nodeNewestNext,e["Node.js"].replace(/^v/,""))&&l().gt(e._nodeNewestNext,e._nodeNewest)&&(i+=(i?" / ":"")+e._nodeNewestNext)}catch{}if(i){const s=this.state.nodeUpdateSupported&&"linux"===e.Platform;i=(0,f.jsx)(d.Tooltip,{title:this.props.t("Some updates available"),slotProps:{popper:{sx:A.tooltip}},children:(0,f.jsxs)("span",{style:{...A.nodeUpdate,display:"inline-flex"},children:["(",i,")",s?(0,f.jsx)(c.Refresh,{style:A.updateIcon,onClick:()=>this.setState({nodeUpdateDialog:{hostId:t,version:e._nodeNewestNext}})}):null]})})}try{e._npmNewest&&e.NPM&&l().gt(e._npmNewest,e.NPM)&&(s=e._npmNewest)}catch{}try{e._npmNewest!==e._npmNewestNext&&e._npmNewestNext&&e.NPM&&e._npmNewest&&l().gt(e._npmNewestNext,e.NPM)&&l().gt(e._npmNewestNext,e._npmNewest)&&(s+=(s?" / ":"")+e._npmNewestNext)}catch{}s&&(s=(0,f.jsx)(d.Tooltip,{title:this.props.t("Some updates available"),slotProps:{popper:{sx:A.tooltip}},children:(0,f.jsxs)("span",{style:A.nodeUpdate,children:["(",s,")"]})}))}return e&&"object"===typeof e?(0,f.jsxs)("ul",{style:{textTransform:"none"},children:[(0,f.jsx)("li",{children:(0,f.jsxs)("span",{children:[(0,f.jsxs)("span",{style:A.bold,children:[this.t("Platform"),": "]}),e.Platform||"--"]})}),(0,f.jsx)("li",{children:(0,f.jsxs)("span",{children:[(0,f.jsxs)("span",{style:A.bold,children:[this.t("RAM"),": "]}),U.RAM(e.RAM)]})}),(0,f.jsx)("li",{children:(0,f.jsxs)("span",{children:[(0,f.jsxs)("span",{style:A.bold,children:[this.t("Node.js"),": "]}),(0,f.jsx)("span",{style:i?A.updateExists:A.updateNo,children:e["Node.js"]||"--"}),i]})}),(0,f.jsx)("li",{children:(0,f.jsxs)("span",{children:[(0,f.jsxs)("span",{style:A.bold,children:[this.t("NPM"),": "]}),(0,f.jsx)("span",{className:s?A.updateExists:A.updateNo,children:e.NPM||"--"}),s]})})]}):(0,f.jsxs)("ul",{children:[(0,f.jsx)(d.Skeleton,{}),(0,f.jsx)(d.Skeleton,{}),(0,f.jsx)(d.Skeleton,{}),(0,f.jsx)(d.Skeleton,{})]})}getHostDescriptionAll(t){const e=this.state.hostsData?this.state.hostsData[t]:null;return{el:(0,f.jsx)("ul",{style:{textTransform:"none"},children:e&&"object"===typeof e&&Object.keys(e).filter((t=>!t.startsWith("_")&&null!==e[t]&&void 0!==e[t])).map((t=>(0,f.jsx)("li",{children:e&&"object"===typeof e?(0,f.jsxs)("span",{children:[(0,f.jsxs)("span",{style:A.bold,children:[this.t(t),": "]}),U[t]?U[t](e[t],this.t):("object"===typeof e[t]?JSON.stringify(e[t]):e[t].toString())||"--"]}):(0,f.jsx)(d.Skeleton,{})},t)))}),text:e&&"object"===typeof e?Object.keys(e).reduce(((t,i)=>`${t}${this.t(i)}:${U[i]?U[i](e[i],this.t):("object"===typeof e[i]?JSON.stringify(e[i]):e[i])||"--"}\n`)):""}}async getData(t){try{const e=await this.props.socket.getSystemConfig(t),i=await this.props.socket.getCompactHosts(t),s=await this.getInstances(t,i,e);this.setState({instances:s.instances,hosts:i,deactivated:s.deactivated,introLinks:e&&e.native&&e.native.introLinks?e.native.introLinks:[]});const o=await this.getHostsData(i);await new Promise((t=>{this.setState(o,(()=>t()))}))}catch(e){window.alert(`Cannot get data: ${e}`)}}renderCopiedToast(){return(0,f.jsx)(d.Snackbar,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:this.state.openSnackBar,autoHideDuration:3e3,onClose:()=>this.setState({openSnackBar:!1}),message:this.t("copied")})}render(){return this.state.instances?(0,f.jsxs)(h.TabContainer,{elevation:0,overflow:"visible",children:[this.renderCopiedToast(),this.state.nodeUpdateDialog?(0,f.jsx)(O,{onClose:()=>this.setState({nodeUpdateDialog:null}),socket:this.props.socket,...this.state.nodeUpdateDialog}):null,(0,f.jsxs)(h.TabContent,{style:A.container,children:[(0,f.jsx)(f.Fragment,{children:(0,f.jsxs)(d.Grid2,{container:!0,spacing:2,children:[this.getInstancesCards(),this.getLinkCards()]})}),this.getButtons(),this.editLinkCard()]})]}):(0,f.jsx)(d.LinearProgress,{})}static preprocessHostData(t){var e;if(null!==(e=t.dockerInformation)&&void 0!==e&&e.isDocker){let e=t.dockerInformation.isOfficial?"official image":"unofficial image";t.dockerInformation.isOfficial&&(e+=` - ${t.dockerInformation.officialVersion}`),t.Platform=`${t.Platform} (${e})`}return delete t.dockerInformation,t}}const B=P},4473:(t,e,i)=>{function s(t,e){if(!{}.hasOwnProperty.call(t,e))throw new TypeError("attempted to use private field on non-instance");return t}i.d(e,{A:()=>s})},68341:(t,e,i)=>{i.d(e,{A:()=>o});var s=0;function o(t){return"__private_"+s+++"_"+t}}}]);
//# sourceMappingURL=3363.1b54fb2f.chunk.js.map